FROM	debian:stable-20220801

ARG	DB_NAME MYSQL_ADMIN_USER MYSQL_ROOT_PASSWORD MYSQL_ADMIN_USER MYSQL_ROOT_PASSWORD MYSQL_USER MYSQL_PASSWORD MYSQL_USER MYSQL_PASSWORD

RUN	apt-get	update \
	&& apt-get install -y mariadb-server

RUN	service mariadb start;

#RUN	echo ${DB_NAME} ${MYSQL_ADMIN_USER} ${MYSQL_ROOT_PASSWORD} ${MYSQL_ADMIN_USER} ${MYSQL_ROOT_PASSWORD} ${MYSQL_USER} ${MYSQL_PASSWORD} ${MYSQL_USER} ${MYSQL_PASSWORD} > /tmp/logs;

RUN	mysql -e \
	"CREATE DATABASE IF NOT EXISTS ${DB_NAME}; \
	CREATE USER IF NOT EXISTS '${MYSQL_ADMIN_USER}' IDENTIFIED BY '${MYSQL_ROOT_PASSWORD}'; \
	GRANT ALL PRIVILEGES ON *.* TO '${MYSQL_ADMIN_USER}' IDENTIFIED BY '${MYSQL_ROOT_PASSWORD}; \
	CREATE USER IF NOT EXISTS '${MYSQL_USER}' IDENTIFIED BY '${MYSQL_PASSWORD}'; \
	GRANT ALL PRIVILEGES ON *.* TO '${MYSQL_USER}' IDENTIFIED BY '${MYSQL_PASSWORD}'; \
	FLUSH PRIVILEGES";

#COPY	/tools/50-server.cnf etc/mysql/mariadb.conf.d/

#COPY	/tools/configure.sh .


ENTRYPOINT ["tail", "-f", "/dev/null"]
#CMD	["/bin/sh"]
#CMD	["mariadb"]
